<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Listado de Causas</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Mi Sistema Legal</a>
    </div>
  </nav>

  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Listado General de Causas</h1>
    <a href="{% url 'crear_causa' %}" class="btn btn-primary">Añadir Nueva Causa</a>
    </div>

    <div class="card">
      <div class="card-body">
        <table id="tabla-causas" class="table table-striped table-hover" style="width:100%">
          <thead class="table-dark">
            <tr>
              <th>Rol</th>
              <th>Deudor</th>
              <th>Tribunal</th>
              <th>Etapa del Juicio</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody>
            {% for causa in causas %}
            <tr>
              <td><a href="{% url 'detalle_causa' causa.pk %}">{{ causa.rol }}</a></td>
              <td>{{ causa.deudor }}</td>
              <td>{{ causa.tribunal.nombre }}</td>
              <td>{{ causa.get_etapa_juicio_display }}</td>
              <td><span class="badge bg-success">{{ causa.get_estado_causa_display }}</span></td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="5" class="text-center text-muted">No hay causas registradas en el sistema.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
  <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.js"></script>

<script>
  $(document).ready(function() {
    $('#tabla-causas').DataTable({
        // En lugar de una URL, pegamos el objeto de lenguaje completo
        "language": {
            "processing": "Procesando...",
            "lengthMenu": "Mostrar _MENU_ registros",
            "zeroRecords": "No se encontraron resultados",
            "emptyTable": "Ningún dato disponible en esta tabla",
            "info": "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
            "infoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
            "infoFiltered": "(filtrado de un total de _MAX_ registros)",
            "search": "Buscar:",
            "loadingRecords": "Cargando...",
            "paginate": {
                "first": "Primero",
                "last": "Último",
                "next": "Siguiente",
                "previous": "Anterior"
            },
            "aria": {
                "sortAscending": ": Activar para ordenar la columna de manera ascendente",
                "sortDescending": ": Activar para ordenar la columna de manera descendente"
            }
        }
    });
  });
</script>
</body>
</html>